(function (root, factory) {(typeof module === 'object' && module.exports) ? module.exports = factory() : root.InterfaceDatastore = factory()}(typeof self !== 'undefined' ? self : this, function () {
var InterfaceDatastore=(()=>{var Ce=Object.defineProperty;var Xt=r=>Ce(r,"__esModule",{value:!0});var i=(r,e)=>()=>(r&&(e=r(r=0)),e);var y=(r,e)=>()=>(e||r((e={exports:{}}).exports,e),e.exports),l=(r,e)=>{Xt(r);for(var t in e)Ce(r,t,{get:e[t],enumerable:!0})};var De,Ue=i(()=>{De="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW"});var se={};l(se,{customAlphabet:()=>Gt,customRandom:()=>Ne,nanoid:()=>Qt,random:()=>Ie,urlAlphabet:()=>De});var Ie,Ne,Gt,Qt,ne=i(()=>{Ue();Ie=r=>crypto.getRandomValues(new Uint8Array(r)),Ne=(r,e,t)=>{let s=(2<<Math.log(r.length-1)/Math.LN2)-1,n=-~(1.6*s*e/r.length);return()=>{let o="";for(;;){let a=t(n),d=n;for(;d--;)if(o+=r[a[d]&s]||"",o.length===e)return o}}},Gt=(r,e)=>Ne(r,e,Ie),Qt=(r=21)=>{let e="",t=crypto.getRandomValues(new Uint8Array(r));for(;r--;){let s=t[r]&63;s<36?e+=s.toString(36):s<62?e+=(s-26).toString(36).toUpperCase():s<63?e+="_":e+="-"}return e}});function Ht(r,e){if(r.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),s=0;s<t.length;s++)t[s]=255;for(var n=0;n<r.length;n++){var o=r.charAt(n),a=o.charCodeAt(0);if(t[a]!==255)throw new TypeError(o+" is ambiguous");t[a]=n}var d=r.length,p=r.charAt(0),T=Math.log(d)/Math.log(256),b=Math.log(256)/Math.log(d);function k(c){if(c instanceof Uint8Array||(ArrayBuffer.isView(c)?c=new Uint8Array(c.buffer,c.byteOffset,c.byteLength):Array.isArray(c)&&(c=Uint8Array.from(c))),!(c instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(c.length===0)return"";for(var u=0,M=0,g=0,v=c.length;g!==v&&c[g]===0;)g++,u++;for(var E=(v-g)*b+1>>>0,m=new Uint8Array(E);g!==v;){for(var S=c[g],I=0,x=E-1;(S!==0||I<M)&&x!==-1;x--,I++)S+=256*m[x]>>>0,m[x]=S%d>>>0,S=S/d>>>0;if(S!==0)throw new Error("Non-zero carry");M=I,g++}for(var C=E-M;C!==E&&m[C]===0;)C++;for(var J=p.repeat(u);C<E;++C)J+=r.charAt(m[C]);return J}function W(c){if(typeof c!="string")throw new TypeError("Expected String");if(c.length===0)return new Uint8Array;var u=0;if(c[u]!==" "){for(var M=0,g=0;c[u]===p;)M++,u++;for(var v=(c.length-u)*T+1>>>0,E=new Uint8Array(v);c[u];){var m=t[c.charCodeAt(u)];if(m===255)return;for(var S=0,I=v-1;(m!==0||S<g)&&I!==-1;I--,S++)m+=d*E[I]>>>0,E[I]=m%256>>>0,m=m/256>>>0;if(m!==0)throw new Error("Non-zero carry");g=S,u++}if(c[u]!==" "){for(var x=v-g;x!==v&&E[x]===0;)x++;for(var C=new Uint8Array(M+(v-x)),J=M;x!==v;)C[J++]=E[x++];return C}}}function Jt(c){var u=W(c);if(u)return u;throw new Error(`Non-${e} character`)}return{encode:k,decodeUnsafe:W,decode:Jt}}var Kt,Yt,Oe,Me=i(()=>{Kt=Ht,Yt=Kt,Oe=Yt});var Ls,Te,D,ke,Le,N=i(()=>{Ls=new Uint8Array(0),Te=(r,e)=>{if(r===e)return!0;if(r.byteLength!==e.byteLength)return!1;for(let t=0;t<r.byteLength;t++)if(r[t]!==e[t])return!1;return!0},D=r=>{if(r instanceof Uint8Array&&r.constructor.name==="Uint8Array")return r;if(r instanceof ArrayBuffer)return new Uint8Array(r);if(ArrayBuffer.isView(r))return new Uint8Array(r.buffer,r.byteOffset,r.byteLength);throw new Error("Unknown type, must be binary type")},ke=r=>new TextEncoder().encode(r),Le=r=>new TextDecoder().decode(r)});var _e,ze,X,Be,G,O,Zt,er,f,A=i(()=>{Me();N();_e=class{constructor(e,t,s){this.name=e,this.prefix=t,this.baseEncode=s}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}},ze=class{constructor(e,t,s){this.name=e,this.prefix=t,this.baseDecode=s}decode(e){if(typeof e=="string")switch(e[0]){case this.prefix:return this.baseDecode(e.slice(1));default:throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`)}else throw Error("Can only multibase decode strings")}or(e){let t={[this.prefix]:this,...e.decoders||{[e.prefix]:e}};return new X(t)}},X=class{constructor(e){this.decoders=e}or(e){let t=e.decoders||{[e.prefix]:e};return new X({...this.decoders,...t})}decode(e){let t=e[0],s=this.decoders[t];if(s)return s.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}},Be=class{constructor(e,t,s,n){this.name=e,this.prefix=t,this.baseEncode=s,this.baseDecode=n,this.encoder=new _e(e,t,s),this.decoder=new ze(e,t,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}},G=({name:r,prefix:e,encode:t,decode:s})=>new Be(r,e,t,s),O=({prefix:r,name:e,alphabet:t})=>{let{encode:s,decode:n}=Oe(t,e);return G({prefix:r,name:e,encode:s,decode:o=>D(n(o))})},Zt=(r,e,t,s)=>{let n={};for(let b=0;b<e.length;++b)n[e[b]]=b;let o=r.length;for(;r[o-1]==="=";)--o;let a=new Uint8Array(o*t/8|0),d=0,p=0,T=0;for(let b=0;b<o;++b){let k=n[r[b]];if(k===void 0)throw new SyntaxError(`Non-${s} character`);p=p<<t|k,d+=t,d>=8&&(d-=8,a[T++]=255&p>>d)}if(d>=t||255&p<<8-d)throw new SyntaxError("Unexpected end of data");return a},er=(r,e,t)=>{let s=e[e.length-1]==="=",n=(1<<t)-1,o="",a=0,d=0;for(let p=0;p<r.length;++p)for(d=d<<8|r[p],a+=8;a>t;)a-=t,o+=e[n&d>>a];if(a&&(o+=e[n&d<<t-a]),s)for(;o.length*t&7;)o+="=";return o},f=({name:r,prefix:e,bitsPerChar:t,alphabet:s})=>G({prefix:e,name:r,encode(n){return er(n,s,t)},decode(n){return Zt(n,s,t,r)}})});var oe={};l(oe,{identity:()=>tr});var tr,Pe=i(()=>{A();N();tr=G({prefix:"\0",name:"identity",encode:r=>Le(r),decode:r=>ke(r)})});var ie={};l(ie,{base2:()=>rr});var rr,Fe=i(()=>{A();rr=f({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1})});var ae={};l(ae,{base8:()=>sr});var sr,Ve=i(()=>{A();sr=f({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3})});var ce={};l(ce,{base10:()=>nr});var nr,qe=i(()=>{A();nr=O({prefix:"9",name:"base10",alphabet:"0123456789"})});var de={};l(de,{base16:()=>or,base16upper:()=>ir});var or,ir,$e=i(()=>{A();or=f({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),ir=f({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4})});var fe={};l(fe,{base32:()=>L,base32hex:()=>fr,base32hexpad:()=>pr,base32hexpadupper:()=>ur,base32hexupper:()=>hr,base32pad:()=>cr,base32padupper:()=>dr,base32upper:()=>ar,base32z:()=>lr});var L,ar,cr,dr,fr,hr,pr,ur,lr,he=i(()=>{A();L=f({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),ar=f({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),cr=f({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),dr=f({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),fr=f({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),hr=f({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),pr=f({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),ur=f({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),lr=f({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5})});var pe={};l(pe,{base36:()=>br,base36upper:()=>mr});var br,mr,We=i(()=>{A();br=O({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),mr=O({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"})});var ue={};l(ue,{base58btc:()=>j,base58flickr:()=>yr});var j,yr,le=i(()=>{A();j=O({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),yr=O({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"})});var be={};l(be,{base64:()=>wr,base64pad:()=>gr,base64url:()=>xr,base64urlpad:()=>vr});var wr,gr,xr,vr,Je=i(()=>{A();wr=f({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),gr=f({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),xr=f({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),vr=f({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6})});function Ge(r,e,t){e=e||[],t=t||0;for(var s=t;r>=jr;)e[t++]=r&255|Xe,r/=128;for(;r&Ar;)e[t++]=r&255|Xe,r>>>=7;return e[t]=r|0,Ge.bytes=t-s+1,e}function me(r,e){var t=0,e=e||0,s=0,n=e,o,a=r.length;do{if(n>=a)throw me.bytes=0,new RangeError("Could not decode varint");o=r[n++],t+=s<28?(o&Qe)<<s:(o&Qe)*Math.pow(2,s),s+=7}while(o>=Dr);return me.bytes=n-e,t}var Er,Xe,Sr,Ar,jr,Cr,Dr,Qe,Ur,Ir,Nr,Or,Mr,Tr,kr,Lr,Rr,_r,zr,Br,B,He=i(()=>{Er=Ge,Xe=128,Sr=127,Ar=~Sr,jr=Math.pow(2,31);Cr=me,Dr=128,Qe=127;Ur=Math.pow(2,7),Ir=Math.pow(2,14),Nr=Math.pow(2,21),Or=Math.pow(2,28),Mr=Math.pow(2,35),Tr=Math.pow(2,42),kr=Math.pow(2,49),Lr=Math.pow(2,56),Rr=Math.pow(2,63),_r=function(r){return r<Ur?1:r<Ir?2:r<Nr?3:r<Or?4:r<Mr?5:r<Tr?6:r<kr?7:r<Lr?8:r<Rr?9:10},zr={encode:Er,decode:Cr,encodingLength:_r},Br=zr,B=Br});var P,R,_,Q=i(()=>{He();P=r=>[B.decode(r),B.decode.bytes],R=(r,e,t=0)=>(B.encode(r,e,t),e),_=r=>B.encodingLength(r)});var H,Ye,Ze,F,K=i(()=>{N();Q();H=(r,e)=>{let t=e.byteLength,s=_(r),n=s+_(t),o=new Uint8Array(n+t);return R(r,o,0),R(t,o,s),o.set(e,n),new F(r,t,e,o)},Ye=r=>{let e=D(r),[t,s]=P(e),[n,o]=P(e.subarray(s)),a=e.subarray(s+o);if(a.byteLength!==n)throw new Error("Incorrect length");return new F(t,n,a,e)},Ze=(r,e)=>r===e?!0:r.code===e.code&&r.size===e.size&&Te(r.bytes,e.bytes),F=class{constructor(e,t,s,n){this.code=e,this.size=t,this.digest=s,this.bytes=n}}});var V,tt,Y=i(()=>{K();V=({name:r,code:e,encode:t})=>new tt(r,e,t),tt=class{constructor(e,t,s){this.name=e,this.code=t,this.encode=s}async digest(e){if(e instanceof Uint8Array){let t=await this.encode(e);return H(this.code,t)}else throw Error("Unknown type, must be binary type")}}});var ye={};l(ye,{sha256:()=>Pr,sha512:()=>Fr});var st,Pr,Fr,nt=i(()=>{Y();st=r=>async e=>new Uint8Array(await crypto.subtle.digest(r,e)),Pr=V({name:"sha2-256",code:18,encode:st("SHA-256")}),Fr=V({name:"sha2-512",code:19,encode:st("SHA-512")})});var we={};l(we,{identity:()=>Vr});var Vr,ot=i(()=>{Y();N();Vr=V({name:"identity",code:0,encode:r=>D(r)})});var it=i(()=>{N()});var at=i(()=>{});var h,Wr,Jr,Xr,q,Gr,ct,dt,Z,ee,Qr,Hr,Kr,ft=i(()=>{Q();K();le();he();N();h=class{constructor(e,t,s,n){this.code=t,this.version=e,this.multihash=s,this.bytes=n,this.byteOffset=n.byteOffset,this.byteLength=n.byteLength,this.asCID=this,this._baseCache=new Map,Object.defineProperties(this,{byteOffset:ee,byteLength:ee,code:Z,version:Z,multihash:Z,bytes:Z,_baseCache:ee,asCID:ee})}toV0(){switch(this.version){case 0:return this;default:{let{code:e,multihash:t}=this;if(e!==q)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==Gr)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return h.createV0(t)}}}toV1(){switch(this.version){case 0:{let{code:e,digest:t}=this.multihash,s=H(e,t);return h.createV1(this.code,s)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}equals(e){return e&&this.code===e.code&&this.version===e.version&&Ze(this.multihash,e.multihash)}toString(e){let{bytes:t,version:s,_baseCache:n}=this;switch(s){case 0:return Jr(t,n,e||j.encoder);default:return Xr(t,n,e||L.encoder)}}toJSON(){return{code:this.code,version:this.version,hash:this.multihash.bytes}}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return"CID("+this.toString()+")"}static isCID(e){return Hr(/^0\.0/,Kr),!!(e&&(e[dt]||e.asCID===e))}get toBaseEncodedString(){throw new Error("Deprecated, use .toString()")}get codec(){throw new Error('"codec" property is deprecated, use integer "code" property instead')}get buffer(){throw new Error("Deprecated .buffer property, use .bytes to get Uint8Array instead")}get multibaseName(){throw new Error('"multibaseName" property is deprecated')}get prefix(){throw new Error('"prefix" property is deprecated')}static asCID(e){if(e instanceof h)return e;if(e!=null&&e.asCID===e){let{version:t,code:s,multihash:n,bytes:o}=e;return new h(t,s,n,o||ct(t,s,n.bytes))}else if(e!=null&&e[dt]===!0){let{version:t,multihash:s,code:n}=e,o=Ye(s);return h.create(t,n,o)}else return null}static create(e,t,s){if(typeof t!="number")throw new Error("String codecs are no longer supported");switch(e){case 0:{if(t!==q)throw new Error(`Version 0 CID must use dag-pb (code: ${q}) block encoding`);return new h(e,t,s,s.bytes)}case 1:{let n=ct(e,t,s.bytes);return new h(e,t,s,n)}default:throw new Error("Invalid version")}}static createV0(e){return h.create(0,q,e)}static createV1(e,t){return h.create(1,e,t)}static decode(e){let[t,s]=h.decodeFirst(e);if(s.length)throw new Error("Incorrect length");return t}static decodeFirst(e){let t=h.inspectBytes(e),s=t.size-t.multihashSize,n=D(e.subarray(s,s+t.multihashSize));if(n.byteLength!==t.multihashSize)throw new Error("Incorrect length");let o=n.subarray(t.multihashSize-t.digestSize),a=new F(t.multihashCode,t.digestSize,o,n);return[t.version===0?h.createV0(a):h.createV1(t.codec,a),e.subarray(t.size)]}static inspectBytes(e){let t=0,s=()=>{let[k,W]=P(e.subarray(t));return t+=W,k},n=s(),o=q;if(n===18?(n=0,t=0):n===1&&(o=s()),n!==0&&n!==1)throw new RangeError(`Invalid CID version ${n}`);let a=t,d=s(),p=s(),T=t+p,b=T-a;return{version:n,codec:o,multihashCode:d,digestSize:p,multihashSize:b,size:T}}static parse(e,t){let[s,n]=Wr(e,t),o=h.decode(n);return o._baseCache.set(s,e),o}},Wr=(r,e)=>{switch(r[0]){case"Q":{let t=e||j;return[j.prefix,t.decode(`${j.prefix}${r}`)]}case j.prefix:{let t=e||j;return[j.prefix,t.decode(r)]}case L.prefix:{let t=e||L;return[L.prefix,t.decode(r)]}default:{if(e==null)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[r[0],e.decode(r)]}}},Jr=(r,e,t)=>{let{prefix:s}=t;if(s!==j.prefix)throw Error(`Cannot string encode V0 in ${t.name} encoding`);let n=e.get(s);if(n==null){let o=t.encode(r).slice(1);return e.set(s,o),o}else return n},Xr=(r,e,t)=>{let{prefix:s}=t,n=e.get(s);if(n==null){let o=t.encode(r);return e.set(s,o),o}else return n},q=112,Gr=18,ct=(r,e,t)=>{let s=_(r),n=s+_(e),o=new Uint8Array(n+t.byteLength);return R(r,o,0),R(e,o,s),o.set(t,n),o},dt=Symbol.for("@ipld/js-cid/CID"),Z={writable:!1,configurable:!1,enumerable:!0},ee={writable:!1,enumerable:!1,configurable:!1},Qr="0.0.0-dev",Hr=(r,e)=>{if(r.test(Qr))console.warn(e);else throw new Error(e)},Kr=`CID.isCID(v) is deprecated and will be removed in the next major release.
Following code pattern:

if (CID.isCID(value)) {
  doSomethingWithCID(value)
}

Is replaced with:

const cid = CID.asCID(value)
if (cid) {
  // Make sure to use cid instead of value
  doSomethingWithCID(cid)
}
`});var ht=i(()=>{ft();Q();N();Y();K()});var ge,ln,pt=i(()=>{Pe();Fe();Ve();qe();$e();he();We();le();Je();nt();ot();it();at();ht();ge={...oe,...ie,...ae,...ce,...de,...fe,...pe,...ue,...be},ln={...ye,...we}});function ut(r,e,t,s){return{name:r,prefix:e,encoder:{name:r,prefix:e,encode:t},decoder:{decode:s}}}var lt,xe,Yr,te,ve=i(()=>{pt();lt=ut("utf8","u",r=>{let e=new TextDecoder("utf8");return"u"+e.decode(r)},r=>new TextEncoder().encode(r.substring(1))),xe=ut("ascii","a",r=>{let e="a";for(let t=0;t<r.length;t++)e+=String.fromCharCode(r[t]);return e},r=>{r=r.substring(1);let e=new Uint8Array(r.length);for(let t=0;t<r.length;t++)e[t]=r.charCodeAt(t);return e}),Yr={utf8:lt,"utf-8":lt,hex:ge.base16,latin1:xe,ascii:xe,binary:xe,...ge},te=Yr});var bt={};l(bt,{toString:()=>Zr});function Zr(r,e="utf8"){let t=te[e];if(!t)throw new Error(`Unsupported encoding "${e}"`);return t.encoder.encode(r).substring(1)}var mt=i(()=>{ve()});var yt={};l(yt,{fromString:()=>es});function es(r,e="utf8"){let t=te[e];if(!t)throw new Error(`Unsupported encoding "${e}"`);return t.decoder.decode(`${t.prefix}${r}`)}var wt=i(()=>{ve()});var Ee=y((xn,xt)=>{"use strict";var{nanoid:ts}=(ne(),se),{toString:rs}=(mt(),bt),{fromString:ss}=(wt(),yt),U="/",gt=new TextEncoder().encode(U),re=gt[0],w=class{constructor(e,t){if(typeof e=="string")this._buf=ss(e);else if(e instanceof Uint8Array)this._buf=e;else throw new Error("Invalid key, should be String of Uint8Array");if(t==null&&(t=!0),t&&this.clean(),this._buf.byteLength===0||this._buf[0]!==re)throw new Error("Invalid key")}toString(e="utf8"){return rs(this._buf,e)}uint8Array(){return this._buf}get[Symbol.toStringTag](){return`Key(${this.toString()})`}static withNamespaces(e){return new w(e.join(U))}static random(){return new w(ts().replace(/-/g,""))}clean(){if((!this._buf||this._buf.byteLength===0)&&(this._buf=gt),this._buf[0]!==re){let e=new Uint8Array(this._buf.byteLength+1);e.fill(re,0,1),e.set(this._buf,1),this._buf=e}for(;this._buf.byteLength>1&&this._buf[this._buf.byteLength-1]===re;)this._buf=this._buf.subarray(0,-1)}less(e){let t=this.list(),s=e.list();for(let n=0;n<t.length;n++){if(s.length<n+1)return!1;let o=t[n],a=s[n];if(o<a)return!0;if(o>a)return!1}return t.length<s.length}reverse(){return w.withNamespaces(this.list().slice().reverse())}namespaces(){return this.list()}baseNamespace(){let e=this.namespaces();return e[e.length-1]}list(){return this.toString().split(U).slice(1)}type(){return ns(this.baseNamespace())}name(){return os(this.baseNamespace())}instance(e){return new w(this.toString()+":"+e)}path(){let e=this.parent().toString();return e.endsWith(U)||(e+=U),e+=this.type(),new w(e)}parent(){let e=this.list();return e.length===1?new w(U):new w(e.slice(0,-1).join(U))}child(e){return this.toString()===U?e:e.toString()===U?this:new w(this.toString()+e.toString(),!1)}isAncestorOf(e){return e.toString()===this.toString()?!1:e.toString().startsWith(this.toString())}isDecendantOf(e){return e.toString()===this.toString()?!1:this.toString().startsWith(e.toString())}isTopLevel(){return this.list().length===1}concat(...e){return w.withNamespaces([...this.namespaces(),...is(e.map(t=>t.namespaces()))])}};function ns(r){let e=r.split(":");return e.length<2?"":e.slice(0,-1).join(":")}function os(r){let e=r.split(":");return e[e.length-1]}function is(r){return[].concat(...r)}xt.exports=w});var Et=y((vn,vt)=>{"use strict";var{nanoid:as}=(ne(),se),cs=(r=e=>e)=>r(as());vt.exports=cs});var At=y((En,St)=>{"use strict";var ds=async r=>{let e=[];for await(let t of r)e.push(t);return e};St.exports=ds});var Se=y((Sn,jt)=>{"use strict";var fs=Et(),hs=At(),ps=(r,e)=>async function*(){yield*(await hs(r)).sort(e)}(),us=(r,e)=>{let t=new RegExp("^"+e);return r.replace(t,"")};jt.exports={sortAll:ps,tmpdir:fs,replaceStartWith:us}});var Dt=y((An,Ct)=>{"use strict";var ls=async r=>{for await(let e of r);};Ct.exports=ls});var It=y((jn,Ut)=>{"use strict";var bs=async function*(r,e){for await(let t of r)await e(t)&&(yield t)};Ut.exports=bs});var Ot=y((Cn,Nt)=>{"use strict";var ms=async function*(r,e){let t=0;if(!(e<1)){for await(let s of r)if(yield s,t++,t===e)return}};Nt.exports=ms});var Ae=y((Dn,Rt)=>{"use strict";var{sortAll:Mt}=Se(),Tt=Dt(),z=It(),kt=Ot(),Lt=class{open(){return Promise.reject(new Error(".open is not implemented"))}close(){return Promise.reject(new Error(".close is not implemented"))}put(e,t,s){return Promise.reject(new Error(".put is not implemented"))}get(e,t){return Promise.reject(new Error(".get is not implemented"))}has(e,t){return Promise.reject(new Error(".has is not implemented"))}delete(e,t){return Promise.reject(new Error(".delete is not implemented"))}async*putMany(e,t={}){for await(let{key:s,value:n}of e)await this.put(s,n,t),yield{key:s,value:n}}async*getMany(e,t={}){for await(let s of e)yield this.get(s,t)}async*deleteMany(e,t={}){for await(let s of e)await this.delete(s,t),yield s}batch(){let e=[],t=[];return{put(s,n){e.push({key:s,value:n})},delete(s){t.push(s)},commit:async s=>{await Tt(this.putMany(e,s)),e=[],await Tt(this.deleteMany(t,s)),t=[]}}}async*_all(e,t){throw new Error("._all is not implemented")}async*_allKeys(e,t){throw new Error("._allKeys is not implemented")}query(e,t){let s=this._all(e,t);if(e.prefix!=null&&(s=z(s,n=>n.key.toString().startsWith(e.prefix))),Array.isArray(e.filters)&&(s=e.filters.reduce((n,o)=>z(n,o),s)),Array.isArray(e.orders)&&(s=e.orders.reduce((n,o)=>Mt(n,o),s)),e.offset!=null){let n=0;s=z(s,()=>n++>=e.offset)}return e.limit!=null&&(s=kt(s,e.limit)),s}queryKeys(e,t){let s=this._allKeys(e,t);if(e.prefix!=null&&(s=z(s,n=>n.toString().startsWith(e.prefix))),Array.isArray(e.filters)&&(s=e.filters.reduce((n,o)=>z(n,o),s)),Array.isArray(e.orders)&&(s=e.orders.reduce((n,o)=>Mt(n,o),s)),e.offset!=null){let n=0;s=z(s,()=>n++>=e.offset)}return e.limit!=null&&(s=kt(s,e.limit)),s}};Rt.exports=Lt});var Bt=y((Un,zt)=>{"use strict";function _t(r,e){for(let t in e)Object.defineProperty(r,t,{value:e[t],enumerable:!0,configurable:!0});return r}function ys(r,e,t){if(!r||typeof r=="string")throw new TypeError("Please pass an Error to err-code");t||(t={}),typeof e=="object"&&(t=e,e=""),e&&(t.code=e);try{return _t(r,t)}catch(s){t.message=r.message,t.stack=r.stack;let n=function(){};return n.prototype=Object.create(Object.getPrototypeOf(r)),_t(new n,t)}}zt.exports=ys});var je=y((In,Pt)=>{"use strict";var $=Bt();function ws(r){return r=r||new Error("Cannot open database"),$(r,"ERR_DB_OPEN_FAILED")}function gs(r){return r=r||new Error("Delete failed"),$(r,"ERR_DB_DELETE_FAILED")}function xs(r){return r=r||new Error("Write failed"),$(r,"ERR_DB_WRITE_FAILED")}function vs(r){return r=r||new Error("Not Found"),$(r,"ERR_NOT_FOUND")}function Es(r){return r=r||new Error("Aborted"),$(r,"ERR_ABORTED")}Pt.exports={dbOpenFailedError:ws,dbDeleteFailedError:gs,dbWriteFailedError:xs,notFoundError:vs,abortedError:Es}});var $t=y((Nn,qt)=>{"use strict";var Ft=Ee(),Ss=Ae(),As=je(),Vt=class extends Ss{constructor(){super();this.data={}}open(){return Promise.resolve()}close(){return Promise.resolve()}async put(e,t){this.data[e.toString()]=t}async get(e){if(!await this.has(e))throw As.notFoundError();return this.data[e.toString()]}async has(e){return this.data[e.toString()]!==void 0}async delete(e){delete this.data[e.toString()]}async*_all(){yield*Object.entries(this.data).map(([e,t])=>({key:new Ft(e),value:t}))}async*_allKeys(){yield*Object.entries(this.data).map(([e])=>new Ft(e))}};qt.exports=Vt});var Ns=y((On,Wt)=>{"use strict";var js=Ee(),Cs=$t(),Ds=Se(),Us=je(),Is=Ae();Wt.exports={Key:js,MemoryDatastore:Cs,utils:Ds,Errors:Us,Adapter:Is}});return Ns();})();
return InterfaceDatastore}));
